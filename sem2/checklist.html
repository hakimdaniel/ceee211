<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>Topik Checklist</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body.dark-mode {
      background-color: #121212;
      color: #e0e0e0;
    }
    body.dark-mode .form-check-label {
      color: #e0e0e0;
    }
    .floating-button {
      position: fixed;
      bottom: 20px;
      right: 20px;
      z-index: 1000;
      font-size: 1.5rem;
      padding: 0.6rem 1rem;
      border-radius: 50%;
      line-height: 1;
    }
  </style>
</head>
<body class="p-4">

  <div class="container">
    <h1 class="mb-4">Checklist Topik Matematik</h1>
    <div id="topic-list"></div>
    <button class="btn btn-danger mt-4" onclick="resetChecklist()">Reset Semua</button>
  </div>

  <!-- Floating Icon Button -->
  <button class="btn btn-secondary floating-button" onclick="toggleDarkMode()" id="darkModeBtn">üåô</button>

  <script>
    const data = [
      {
        title: "1. METHOD OF INTEGRATION",
        id: "topic1",
        children: [
          "1.1 Integration by Parts",
          "1.2 Integration of Trigonometric Functions",
          "1.3 Integration of Trigonometric Substitution",
          "1.4 Integration of Rational Function",
          "Exercise"
        ]
      },
      {
        title: "2. FUNCTION OF TWO VARIABLES",
        id: "topic2",
        children: [
          "2.1 Introduction",
          "2.2 Function of Two Variables",
          "2.3 Partial Derivatives",
          "2.4 Rule of Partial Derivative",
          "2.5 Higher Order Partial Derivative",
          "2.6 Application of Partial Derivative",
          "‚ÄÉ2.6.1 Implicit Function of Two Variables and Its Application",
          "‚ÄÉ2.6.2 Total Differential",
          "‚ÄÉ2.6.3 Chain Rule and Its Application",
          "‚ÄÉ2.6.4 Extremum of Function",
          "Exercise"
        ]
      },
      {
        title: "3. DIFFERENTIAL EQUATIONS",
        id: "topic3",
        children: [
          "3.1 First Order Differential Equation",
          "‚ÄÉ3.1.1 Separable Equation",
          "‚ÄÉ3.1.2 Linear Equation",
          "3.2 Application of First Order Separable Equation",
          "‚ÄÉ3.2.1 Population Growth",
          "‚ÄÉ3.2.2 Newton‚Äôs Law of Cooling",
          "3.3 Application of First Order Linear Equation",
          "‚ÄÉ3.3.1 Electric Circuit",
          "‚ÄÉ3.3.2 Mixing Problems",
          "Exercise"
        ]
      }
    ];

    function saveToStorage() {
      const checkboxes = document.querySelectorAll('input[type=checkbox]');
      const saved = {};
      checkboxes.forEach(cb => {
        saved[cb.id] = cb.checked;
      });
      localStorage.setItem("topicChecklist", JSON.stringify(saved));
    }

    function loadFromStorage() {
      const saved = JSON.parse(localStorage.getItem("topicChecklist")) || {};
      Object.entries(saved).forEach(([id, checked]) => {
        const cb = document.getElementById(id);
        if (cb) cb.checked = checked;
      });
    }

    function resetChecklist() {
      localStorage.removeItem("topicChecklist");
      document.querySelectorAll('input[type=checkbox]').forEach(cb => cb.checked = false);
    }

    function renderTopics() {
      const container = document.getElementById("topic-list");

      data.forEach((topic, i) => {
        const section = document.createElement("div");
        section.className = "mb-4";

        const parentId = `parent-${topic.id}`;
        section.innerHTML += `
          <div class="form-check">
            <input class="form-check-input parent-checkbox" type="checkbox" id="${parentId}">
            <label class="form-check-label fw-bold" for="${parentId}">
              ${topic.title}
            </label>
          </div>
        `;

        topic.children.forEach((child, j) => {
          const childId = `${topic.id}-sub-${j}`;
          section.innerHTML += `
            <div class="form-check ms-4">
              <input class="form-check-input child-checkbox" type="checkbox" id="${childId}" data-parent="${parentId}">
              <label class="form-check-label" for="${childId}">
                ${child}
              </label>
            </div>
          `;
        });

        container.appendChild(section);
      });
    }

    function setupListeners() {
      document.querySelectorAll(".child-checkbox").forEach(cb => {
        cb.addEventListener("change", () => {
          const parentId = cb.dataset.parent;
          const parent = document.getElementById(parentId);
          const siblings = document.querySelectorAll(`input[data-parent="${parentId}"]`);
          const allChecked = Array.from(siblings).every(c => c.checked);
          parent.checked = allChecked;
          saveToStorage();
        });
      });

      document.querySelectorAll(".parent-checkbox").forEach(parent => {
        parent.addEventListener("change", () => {
          const children = document.querySelectorAll(`input[data-parent="${parent.id}"]`);
          children.forEach(c => c.checked = parent.checked);
          saveToStorage();
        });
      });
    }

    function toggleDarkMode() {
      const body = document.body;
      const btn = document.getElementById("darkModeBtn");
      const isDark = body.classList.toggle("dark-mode");
      localStorage.setItem("darkMode", isDark);
      btn.innerText = isDark ? "‚òÄÔ∏è" : "üåô";
    }

    function loadDarkMode() {
      const isDark = localStorage.getItem("darkMode") === "true";
      if (isDark) {
        document.body.classList.add("dark-mode");
        document.getElementById("darkModeBtn").innerText = "‚òÄÔ∏è";
      }
    }

    // Init
    renderTopics();
    loadFromStorage();
    setupListeners();
    loadDarkMode();
  </script>

</body>
</html>
